@using Microsoft.AspNetCore.Components.Forms

<h1>EditCheckedEnumList Demo</h1>

<EditForm Model="@_model" class="flex-row flex-wrap" @ref=_form>
    <ObjectGraphDataAnnotationsValidator />

    <section class="demo-section">
        <EditCheckedEnumList @bind-Value="_model.BasicEnumList"
                             Field="@(() => _model.BasicEnumList)" />
        
        <h3>Markup</h3>
        <pre class="code-block"><code>@_basicExample</code></pre>
    </section>

    <section class="demo-section">
        <EditCheckedEnumList @bind-Value="_model.BasicEnumList"
                             Field="@(() => _model.BasicEnumList)"
                             Label="Read-only"
                             IsEditMode="false" />
        
        <h3>Markup</h3>
        <pre class="code-block"><code>@_readOnlyExample</code></pre>
    </section>

    <section class="demo-section">
        <EditCheckedEnumList @bind-Value="_model.SortedEnumList"
                             Field="@(() => _model.SortedEnumList)"
                             Label="Sorted"
                             Sort="true" />
        
        <h3>Markup</h3>
        <pre class="code-block"><code>@_sortedExample</code></pre>
    </section>

    <section class="demo-section">
        <EditCheckedEnumList @bind-Value="_model.HorizontalLayout"
                             Field="@(() => _model.HorizontalLayout)"
                             Label="Horizontal Layout"
                             IsHorizontal="true" />
        
        <h3>Markup</h3>
        <pre class="code-block"><code>@_horizontalExample</code></pre>
    </section>

    <section class="demo-section">
        <style>
            .my-custom-container {
                background-color: lightblue;
                padding: 10px;
                border-radius: 4px;
            }

            .my-custom-checklist {
                display: flex;
                flex-direction: column;
                gap: 8px;
                font-weight: bold;
            }

                .my-custom-checklist input[type="checkbox"] {
                    transform: scale(1.2);
                    margin-right: 8px;
                    accent-color: blue;
                }
        </style>

        <EditCheckedEnumList @bind-Value="_model.CustomStyling"
                             Field="@(() => _model.CustomStyling)"
                             ContainerClass="my-custom-container"
                             LabelClass="my-custom-checklist" />
        
        <h3>Markup</h3>
        <pre class="code-block"><code>@_customStyleExample</code></pre>
        
        <h3>CSS</h3>
        <pre class="code-block code-block-css"><code>@_customStyleCss</code></pre>
    </section>

    <section class="demo-section">
        <EditCheckedEnumList @bind-Value="_model.Disabled"
                             Field="@(() => _model.Disabled)"
                             IsDisabled="true" />

        <EditCheckedEnumList @bind-Value="_model.Required"
                             Field="@(() => _model.Required)" />
        
        <h3>Markup</h3>
        <pre class="code-block"><code>@_validationExample</code></pre>
        
        <h3>Model</h3>
        <pre class="code-block code-block-model"><code>@_validationModel</code></pre>
    </section>

</EditForm>

@code {
    readonly DemoEditCheckedEnumListModel _model = new();

    EditForm? _form;
    
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && _form?.EditContext != null)
        {
            // Use small delay to ensure component is fully rendered before validation
            await Task.Delay(10);
            _form.EditContext.Validate();
            StateHasChanged();
        }
    }
    
    public class DemoEditCheckedEnumListModel
    {
        [Description("Basic Description")]
        public List<Animal> BasicEnumList { get; set; } = [];
        
        public List<Animal> SortedEnumList { get; set; } = [];
        
        public List<Animal> HorizontalLayout { get; set; } = [];
        
        public List<Animal> CustomStyling { get; set; } = [];

        [Required, MinLength(2)]
        public List<Animal> Required { get; set; } = [];

        public List<Animal> Disabled { get; set; } = [Animal.Cat, Animal.Dog];
    }

    readonly string _basicExample = @"<EditCheckedEnumList @bind-Value=""_model.BasicEnumList""
                    Field=""@(() => _model.BasicEnumList)"" />";

    readonly string _readOnlyExample = @"<EditCheckedEnumList @bind-Value=""_model.BasicEnumList""
                    Field=""@(() => _model.BasicEnumList)""
                    Label=""Read-only""
                    IsEditMode=""false"" />";

    readonly string _sortedExample = @"<EditCheckedEnumList @bind-Value=""_model.SortedEnumList""
                    Field=""@(() => _model.SortedEnumList)""
                    Label=""Sorted""
                    Sort=""true"" />";

    readonly string _horizontalExample = @"<EditCheckedEnumList @bind-Value=""_model.HorizontalLayout""
                    Field=""@(() => _model.HorizontalLayout)""
                    Label=""Horizontal Layout""
                    IsHorizontal=""true"" />";

    readonly string _customStyleExample = @"<EditCheckedEnumList @bind-Value=""_model.CustomStyling""
                    Field=""@(() => _model.CustomStyling)""
                    ContainerClass=""my-custom-container""
                    LabelClass=""my-custom-checklist"" />";

    readonly string _customStyleCss = @".my-custom-container {
    background-color: lightblue;
    padding: 10px;
    border-radius: 4px;
}

.my-custom-checklist {
    display: flex;
    flex-direction: column;
    gap: 8px;
    font-weight: bold;
}

.my-custom-checklist input[type=""checkbox""] {
    transform: scale(1.2);
    margin-right: 8px;
    accent-color: blue;
}";

    readonly string _validationExample = @"<EditCheckedEnumList @bind-Value=""_model.Disabled""
                    Field=""@(() => _model.Disabled)""
                    IsDisabled=""true"" />

<EditCheckedEnumList @bind-Value=""_model.Required""
                    Field=""@(() => _model.Required)"" />";

    readonly string _validationModel = @"[Required, MinLength(2)]
public List<Animal> Required { get; set; } = [];

public List<Animal> Disabled { get; set; } = [Animal.Cat, Animal.Dog];";
}