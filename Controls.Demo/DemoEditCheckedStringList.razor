@using Microsoft.AspNetCore.Components.Forms

<h1>EditCheckedStringList Demo</h1>

<EditForm Model="@_model" class="flex-row flex-wrap" @ref=_form>
    <ObjectGraphDataAnnotationsValidator />

    <section class="demo-section">
        <EditCheckedStringList @bind-Value="_model.BasicList"
                               Options="@_basicItems"
                               Field="@(() => _model.BasicList)" />
        
        <h3>Markup</h3>
        <pre class="code-block"><code>@_basicExample</code></pre>
    </section>

    <section class="demo-section">
        <EditCheckedStringList @bind-Value="_model.CustomStyling"
                               Options="@_basicItems"
                               ContainerClass="my-custom-container"
                               LabelClass="my-custom-checklist"
                               Field="@(() => _model.CustomStyling)" />
        
        <h3>Markup</h3>
        <pre class="code-block"><code>@_customStyleExample</code></pre>
        
        <h3>CSS</h3>
        <pre class="code-block code-block-css"><code>@_customStyleCss</code></pre>
    </section>

    <section class="demo-section">
        <EditCheckedStringList @bind-Value="_model.Disabled"
                               Options="@_basicItems"
                               IsDisabled="true"
                               Field="@(() => _model.Disabled)" />

        <EditCheckedStringList @bind-Value="_model.Required"
                               Options="@_basicItems"
                               Field="@(() => _model.Required)" />
        
        <h3>Markup</h3>
        <pre class="code-block"><code>@_validationExample</code></pre>
        
        <h3>Model</h3>
        <pre class="code-block code-block-model"><code>@_validationModel</code></pre>
    </section>

</EditForm>

@code {
    readonly DemoEditCheckedStringListModel _model = new();
    readonly List<string> _basicItems = ["Apple", "Banana", "Orange", "Grape", "Mango"];

    EditForm? _form;
    
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender && _form?.EditContext != null)
        {
            // Use small delay to ensure component is fully rendered before validation
            await Task.Delay(10);
            _form.EditContext.Validate();
            StateHasChanged();
        }
    }
    
    public class DemoEditCheckedStringListModel
    {
        [Description("Basic Description")]
        public List<string> BasicList { get; set; } = [];
        public List<string> WithHtmlLabel { get; set; } = [];
        public List<string> NoLabel { get; set; } = [];
        public List<string> CustomStyling { get; set; } = [];

        [Required, MinLength(2)]
        public List<string> Required { get; set; } = [];

        public List<string> Disabled { get; set; } = [];
    }

    readonly string _basicExample = @"<EditCheckedStringList @bind-Value=""_model.BasicList""
                      Options=""@_basicItems""
                      Field=""@(() => _model.BasicList)"" />";

    readonly string _customStyleExample = @"<EditCheckedStringList @bind-Value=""_model.CustomStyling""
                      Options=""@_basicItems""
                      ContainerClass=""my-custom-container""
                      LabelClass=""my-custom-checklist""
                      Field=""@(() => _model.CustomStyling)"" />";

    readonly string _customStyleCss = @".my-custom-container {
    background-color: teal;
    padding: 10px;
    border-radius: 4px;
}

.my-custom-checklist {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.my-custom-checklist input[type=""checkbox""] {
    transform: scale(1.2);
    margin-right: 8px;
    accent-color: lime;
}";

    readonly string _validationExample = @"<EditCheckedStringList @bind-Value=""_model.Disabled""
                      Options=""@_basicItems""
                      IsDisabled=""true""
                      Field=""@(() => _model.Disabled)"" />

<EditCheckedStringList @bind-Value=""_model.Required""
                      Options=""@_basicItems""
                      Field=""@(() => _model.Required)"" />";

    readonly string _validationModel = @"[Required, MinLength(2)]
public List<string> Required { get; set; } = [];

public List<string> Disabled { get; set; } = [];";

    // For demonstration, providing some basic items
    private List<string> GetBasicItems() => new() { "Apple", "Banana", "Cherry" };
}

<style>
    .my-custom-container {
        background-color: teal;
        padding: 10px;
        border-radius: 4px;
    }

    .my-custom-checklist {
        display: flex;
        flex-direction: column;
        gap: 8px;
    }

        .my-custom-checklist input[type="checkbox"] {
            transform: scale(1.2);
            margin-right: 8px;
            accent-color: lime;
        }
</style>